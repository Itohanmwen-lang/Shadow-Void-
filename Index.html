<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Shadow Lord's Void</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto; touch-action: none; }
        canvas { display: block; }
        
        /* Mobile Dashboard */
        #dashboard {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 15px; background: rgba(20, 20, 20, 0.8);
            padding: 15px 25px; border-radius: 40px; border: 1px solid #333;
            backdrop-filter: blur(10px); z-index: 10;
        }
        
        .btn {
            color: #fff; font-size: 12px; text-transform: uppercase;
            letter-spacing: 1px; cursor: pointer; display: flex; flex-direction: column; align-items: center;
        }

        #stats {
            position: absolute; top: 50px; left: 20px; color: #555; font-size: 10px;
            letter-spacing: 2px; pointer-events: none;
        }
        b { color: #fff; }
    </style>
</head>
<body>

<div id="stats">
    ENTITIES: <b id="count">0</b><br>
    GRAVITY: <b id="grav">EARTH</b>
</div>

<div id="dashboard">
    <div class="btn" onclick="changeGravity()">ü™ê<br>GRAV</div>
    <div class="btn" onclick="spawnMass()">‚ûï<br>MASS</div>
    <div class="btn" onclick="triggerExplosion()">üí•<br>BLAST</div>
    <div class="btn" onclick="clearVoid()">üßπ<br>RESET</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
<script>
    const { Engine, Render, Runner, Bodies, Composite, Mouse, MouseConstraint, Vector } = Matter;
    const engine = Engine.create();
    const world = engine.world;
    
    const render = Render.create({
        element: document.body,
        engine: engine,
        options: {
            width: window.innerWidth,
            height: window.innerHeight,
            wireframes: false,
            background: '#000',
            pixelRatio: window.devicePixelRatio
        }
    });

    Render.run(render);
    Runner.run(Runner.create(), engine);

    // Physical Boundaries
    const thick = 100;
    const walls = [
        Bodies.rectangle(window.innerWidth/2, window.innerHeight + thick/2, window.innerWidth, thick, { isStatic: true }),
        Bodies.rectangle(-thick/2, window.innerHeight/2, thick, window.innerHeight, { isStatic: true }),
        Bodies.rectangle(window.innerWidth + thick/2, window.innerHeight/2, thick, window.innerHeight, { isStatic: true }),
        Bodies.rectangle(window.innerWidth/2, -thick/2, window.innerWidth, thick, { isStatic: true })
    ];
    Composite.add(world, walls);

    // Touch Interaction
    const mouse = Mouse.create(render.canvas);
    const mouseConstraint = MouseConstraint.create(engine, {
        mouse: mouse,
        constraint: { stiffness: 0.1, render: { visible: false } }
    });
    Composite.add(world, mouseConstraint);
    render.mouse = mouse;

    // Mobile Actions
    function spawnMass() {
        for(let i=0; i<3; i++) {
            const size = 30 + Math.random() * 20;
            const body = Bodies.polygon(window.innerWidth/2, 100, Math.floor(Math.random() * 5) + 3, size, {
                restitution: 0.6,
                render: { fillStyle: '#111', strokeStyle: '#444', lineWidth: 2 }
            });
            Composite.add(world, body);
        }
        updateCount();
    }

    function changeGravity() {
        if (world.gravity.y === 1) {
            world.gravity.y = -1;
            document.getElementById('grav').innerText = "REVERSE";
        } else if (world.gravity.y === -1) {
            world.gravity.y = 0;
            document.getElementById('grav').innerText = "ZERO-G";
        } else {
            world.gravity.y = 1;
            document.getElementById('grav').innerText = "EARTH";
        }
    }

    function triggerExplosion() {
        const bodies = Composite.allBodies(world);
        bodies.forEach(b => {
            if(!b.isStatic) {
                const force = Vector.mult(Vector.normalise(Vector.sub(b.position, {x: window.innerWidth/2, y: window.innerHeight/2})), 0.05 * b.mass);
                Matter.Body.applyForce(b, b.position, force);
            }
        });
    }

    function clearVoid() {
        const allBodies = Composite.allBodies(world);
        allBodies.forEach(b => { if(!b.isStatic) Composite.remove(world, b); });
        updateCount();
    }

    function updateCount() {
        document.getElementById('count').innerText = Composite.allBodies(world).length - 4;
    }

    // Double-Tap to spawn where you touch
    window.addEventListener('touchstart', (e) => {
        if (e.touches.length === 1 && e.target.tagName !== 'DIV') {
            const touch = e.touches[0];
            const body = Bodies.circle(touch.clientX, touch.clientY, 25, {
                restitution: 0.5,
                render: { fillStyle: '#000', strokeStyle: '#fff', lineWidth: 1 }
            });
            Composite.add(world, body);
            updateCount();
        }
    });

</script>
</body>
</html>
